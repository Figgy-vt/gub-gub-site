{
  "rules": {
    "leaderboard_v3": {
      ".read": true,
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        "score": {
          ".write": false,
          ".validate": "newData.isNumber() && newData.val() >= 0"
        },
        "username": {
          ".write": "auth != null && auth.uid === $uid",
          ".validate": "newData.isString() && newData.val().matches(/^[A-Za-z0-9_]{3,20}$/)"
        },
        "lastUpdated": {
          ".write": false,
          ".validate": "newData.isNumber()"
        }
      }
    },
    "presence": {
      ".read": true,
      "$uid": {
        ".write": "auth != null && auth.uid === $uid",
        ".validate": "newData.val() == null || (newData.isString() && newData.val().matches(/^[A-Za-z0-9_]{3,20}$/))"
      }
    },
    "chat": {
      ".read": true,
      "$msg": {
        ".write": "auth != null && newData.hasChildren(['user','text','ts'])",
        "user": {
          ".validate": "newData.isString() && newData.val().matches(/^[A-Za-z0-9_]{3,20}$/)"
        },
        "text": {
          ".validate": "newData.isString() && newData.val().length <= 200"
        },
        "ts": {
          ".validate": "newData.isNumber()"
        }
      },
      ".indexOn": ["ts"]
    },
    "admins": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": "auth != null && (auth.uid === 'sGd1ZHR1nvMKKCw9A1O5bwtbFD23' || auth.uid === 'YHtvs4JyAtS3SUtNAUJuPMm3ac22' || root.child('admins').child(auth.uid).val() === true)"
      }
    },
    "shop_v2": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": false,
        "$item": {
          ".validate": "newData.isNumber() && newData.val() >= 0"
        }
      }
    },
    "feedback": {
      ".read": true,
      "$id": {
        ".write": "auth != null && (newData.hasChildren(['user','text','ts']) || (newData.val() == null && root.child('admins').child(auth.uid).val() === true))",
        "user": {
          ".validate": "newData.isString() && newData.val().matches(/^[A-Za-z0-9_]{3,20}$/)"
        },
        "text": {
          ".validate": "newData.isString() && newData.val().length <= 200"
        },
        "ts": {
          ".validate": "newData.isNumber()"
        },
        "votes": {
          "$uid": {
            ".write": "auth != null && auth.uid === $uid",
            ".validate": "newData.val() == 1 || newData.val() == -1 || newData.val() == null"
          }
        },
        "comments": {
          "$cid": {
            ".write": "auth != null && newData.hasChildren(['user','text','ts'])",
            "user": {
              ".validate": "newData.isString() && newData.val().matches(/^[A-Za-z0-9_]{3,20}$/)"
            },
            "text": {
              ".validate": "newData.isString() && newData.val().length <= 200"
            },
            "ts": {
              ".validate": "newData.isNumber()"
            }
          }
        }
      }
    },
    "rateLimits": {
      ".read": false,
      ".write": false
    },
    "goldenTokens": {
      ".read": false,
      ".write": false
    },
    "config": {
      ".read": true,
      ".write": false
    }
  }
}
