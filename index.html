<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>the gub</title>
  <style>
    body{margin:0;overflow:hidden;background:#111;position:relative;height:100vh;width:100vw;}
    #main-gub{max-height:90vh;max-width:90vw;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;}

    /* buttons */
    #chaosBtn,#lowPerfBtn,#speedBtn,#twitchBtn{position:absolute;z-index:9999;background:#fff;color:#000;border:none;border-radius:6px;cursor:pointer;font-weight:bold;font-family:sans-serif;padding:8px 16px;font-size:14px;top:10px;}
    #lowPerfBtn{left:10px;}
    #chaosBtn{left:140px;}
    #twitchBtn{left:345px;}
    #speedBtn{padding:20px 30px;font-size:20px;border-radius:10px;}

    .rainbow-text{font-size:2rem;font-weight:bold;font-family:sans-serif;animation:rainbow 5s linear infinite;white-space:nowrap;position:absolute;pointer-events:none;z-index:2;}
    .floater{position:absolute;pointer-events:none;z-index:2;}
    .floater img{width:100%;height:100%;object-fit:contain;}

    @keyframes rainbow{0%{color:red;}20%{color:orange;}40%{color:yellow;}60%{color:green;}80%{color:blue;}100%{color:violet;}}

    @media(max-width:768px){.floater,.rainbow-text{max-width:150px;max-height:150px;}}

    #visualizer{position:fixed;bottom:0;left:0;right:0;width:100vw;height:100px;z-index:5000;pointer-events:none;}
    #twitchPlayer{position:absolute;top:50px;right:10px;width:320px;height:180px;z-index:9000;display:none;box-shadow:0 0 8px #000;border-radius:8px;overflow:hidden;}
  </style>
  <script src="https://embed.twitch.tv/embed/v1.js"></script>
</head>
<body>
  <button id="lowPerfBtn">Low&nbsp;Perf&nbsp;Mode</button>
  <button id="chaosBtn">Chaos&nbsp;Mode <span style="font-size:10px;">(epilepsy&nbsp;warning)</span></button>
  <button id="twitchBtn">Show&nbsp;Stream</button>
  <button id="speedBtn">Speed&nbsp;Up</button>

  <div id="twitchPlayer"></div>
  <img id="main-gub" src="gub_wicked.png" alt="wickeding gub" />
  <canvas id="visualizer"></canvas>

<script>
window.addEventListener('DOMContentLoaded',()=>{
  const NUM_FLOATERS=20;
  const images=['floater1.jpg','floater2.jpg','floater3.jpg','floater4.png','floater5.jpg','floater6.jpg','floater7.jpg','floater8.jpg', 'floater9.jpg', 'floater10.jpg', 'floater11.jpg', 'floater12.jpg'];
  const texts=["bark", "barke", "gubbling", "good boye", "sniffa", "shidded","gubb", "gubbing", "i'm gonna gub", "he do be gubbin", "were my salami go", "Gub Gubtaro Pissboy420 Bong or Die", "bork", "aaaAAa", "im gubbing it im gubbing it"];

  let speedMultiplier=2;
  const floaters=[];
  function createEntity(isText=false){
    const elem=document.createElement('div');
    const size=80+Math.random()*320;
    elem.style.width=elem.style.height=size+'px';
    elem.style.left=Math.random()*(window.innerWidth-size)+'px';
    elem.style.top=Math.random()*(window.innerHeight-size)+'px';
    if(isText){elem.className='rainbow-text';elem.textContent=texts[Math.floor(Math.random()*texts.length)];}
    else{elem.className='floater';const img=document.createElement('img');img.src=images[Math.floor(Math.random()*images.length)];elem.appendChild(img);}    
    document.body.appendChild(elem);
    floaters.push({elem,x:parseFloat(elem.style.left),y:parseFloat(elem.style.top),vx:(Math.random()-0.5)*2,vy:(Math.random()-0.5)*2,width:size,height:size});
  }
  function animate(){
    floaters.forEach(f=>{f.x+=f.vx*speedMultiplier;f.y+=f.vy*speedMultiplier;if(f.x<=0||f.x+f.width>=window.innerWidth)f.vx*=-1;if(f.y<=0||f.y+f.height>=window.innerHeight)f.vy*=-1;f.elem.style.left=f.x+'px';f.elem.style.top=f.y+'px';});
    requestAnimationFrame(animate);
  }
  for(let i=0;i<NUM_FLOATERS;i++){createEntity(false);createEntity(true);}  
  animate();

  const speedBtn=document.getElementById('speedBtn');
  const chaosBtn=document.getElementById('chaosBtn');
  const lowPerfBtn=document.getElementById('lowPerfBtn');
  const twitchBtn=document.getElementById('twitchBtn');
  const twitchContainer=document.getElementById('twitchPlayer');
  let twitchShown=false;
  twitchBtn.addEventListener('click',()=>{
    if(!twitchShown){
      twitchContainer.style.display='block';
      new Twitch.Embed('twitchPlayer',{width:'100%',height:'100%',channel:'harupi',parent:[location.hostname]});
      twitchBtn.textContent='Hide Stream';
    }else{
      twitchContainer.innerHTML='';
      twitchContainer.style.display='none';
      twitchBtn.textContent='Show Stream';
    }
    twitchShown=!twitchShown;
  });

  function placeSpeedBtn(){speedBtn.style.left=Math.random()*(window.innerWidth-speedBtn.offsetWidth)+'px';speedBtn.style.top=Math.random()*(window.innerHeight-speedBtn.offsetHeight)+'px';}
  placeSpeedBtn();
  speedBtn.addEventListener('click',()=>{speedMultiplier+=1;placeSpeedBtn();});

  let flashing=false;let lowPerf=false;
  lowPerfBtn.addEventListener('click',()=>{lowPerf=!lowPerf;speedMultiplier=lowPerf?1:2;});

  const canvas=document.getElementById('visualizer');
  const ctx=canvas.getContext('2d');
  function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=100;}
  window.addEventListener('resize',resizeCanvas);resizeCanvas();

  const audioCtx=new(window.AudioContext||window.webkitAudioContext)();
  const analyser=audioCtx.createAnalyser();analyser.fftSize=256;const bufferLength=analyser.frequencyBinCount;const dataArray=new Uint8Array(bufferLength);
  const audio=new Audio('music.mp3');audio.loop=true;const source=audioCtx.createMediaElementSource(audio);source.connect(analyser);analyser.connect(audioCtx.destination);
  let musicPlaying=false;let visualizerStarted=false;
  function drawVisualizer(){if(!visualizerStarted)return;requestAnimationFrame(drawVisualizer);analyser.getByteFrequencyData(dataArray);ctx.clearRect(0,0,canvas.width,canvas.height);const barW=canvas.width/bufferLength;for(let i=0;i<bufferLength;i++){const h=dataArray[i];ctx.fillStyle=`hsl(${i*3},100%,50%)`;ctx.fillRect(i*barW,canvas.height-h,barW-1,h);}}

  chaosBtn.addEventListener('click',()=>{
    flashing=!flashing;
    if(flashing){speedMultiplier=6;document.body.style.animation='flash 0.1s infinite alternate';floaters.forEach(f=>{const dur=(0.3+Math.random()*0.7).toFixed(2);const dir=Math.random()>0.5?'alternate':'alternate-reverse';const ease=Math.random()>0.5?'ease-in':'ease-out';f.elem.style.animation=`spinmove ${dur}s infinite ${dir} ${ease}`;});if(!musicPlaying){audioCtx.resume();audio.play();if(!visualizerStarted){visualizerStarted=true;drawVisualizer();}musicPlaying=true;}}
    else{speedMultiplier=lowPerf?1:2;document.body.style.animation='none';document.body.style.background='#111';floaters.forEach(f=>{f.elem.style.animation='none';});if(musicPlaying){audio.pause();musicPlaying=false;}}
  });

  const style=document.createElement('style');
  style.textContent='@keyframes flash{0%{background:#111}25%{background:#ff0}50%{background:#0ff}75%{background:#f0f}100%{background:#111}}@keyframes spinmove{0%{transform:scale(1)rotate(0deg)}50%{transform:scale(1.2)rotate(180deg)}100%{transform:scale(1)rotate(360deg)}}';
  document.head.appendChild(style);
});
</script>
</body>
</html>
